import{Amplify as e}from"aws-amplify";import"../../types/authenticator/user.mjs";import"../../types/authenticator/attributes.mjs";import"../../types/primitives/componentClassName.mjs";import"../../i18n/translations.mjs";import{hasSpecialChars as s}from"../authenticator/utils.mjs";const a=()=>{const s=e.configure(),a=null==s?void 0:s.aws_cognito_password_protection_settings;if(!a)return null;const{passwordPolicyCharacters:t=[],passwordPolicyMinLength:o}=a;return{minLength:o,needsLowerCase:t.includes("REQUIRES_LOWERCASE"),needsUpperCase:t.includes("REQUIRES_UPPERCASE"),needsNumber:t.includes("REQUIRES_NUMBERS"),needsSpecialChar:t.includes("REQUIRES_SYMBOLS")}},t=e=>({validationMode:"onTouched",validator:s=>s.length>=e,message:`Password must have at least ${e} characters`}),o={validationMode:"onTouched",validator:e=>/[a-z]/.test(e),message:"Password must have lower case letters"},r={validationMode:"onTouched",validator:e=>/[A-Z]/.test(e),message:"Password must have upper case letters"},n={validationMode:"onTouched",validator:e=>/[0-9]/.test(e),message:"Password must have numbers"},i={validationMode:"onTouched",validator:e=>s(e),message:"Password must have special characters"},d=e=>({validationMode:"onTouched",validator:s=>e===s,message:"Your passwords must match"}),u=()=>{const e=a();if(!e)return[];const s=[],{minLength:d,needsLowerCase:u,needsUpperCase:l,needsNumber:c,needsSpecialChar:h}=e;return d&&s.push(t(d)),u&&s.push(o),l&&s.push(r),c&&s.push(n),h&&s.push(i),s},l=e=>[d(e)],c=({validationMode:e,eventType:s,hasBlurred:a})=>{switch(e){case"onBlur":return"blur"===s;case"onChange":return"change"===s;case"onTouched":return"blur"===s||a}},h=({value:e,validators:s,eventType:a,hasBlurred:t})=>e?s.reduce(((s,o)=>{const{validator:r,validationMode:n,message:i}=o;if(c({validationMode:n,eventType:a,hasBlurred:t})){return!r(e)?[...s,i]:s}return s}),[]):[];export{l as getDefaultConfirmPasswordValidators,u as getDefaultPasswordValidators,t as getHasMinLength,d as getMatchesConfirmPassword,a as getPasswordRequirement,o as hasLowerCase,n as hasNumber,i as hasSpecialChar,r as hasUpperCase,h as runFieldValidators,c as shouldValidate};
